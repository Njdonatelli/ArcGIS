# -*- coding: utf-8 -*-
# ---------------------------------------------------------------------------
# CIS Formatter.py
# Created on: 2024-05-20 12:55:58.00000
#   (generated by ArcGIS/ModelBuilder)
# Usage: CIS Formatter <Autodialer_CSV_Output> <WorkOrder> 
# Description: 
# ---------------------------------------------------------------------------

# Set the necessary product code
# import arcinfo


# Import arcpy module
import arcpy

# Script arguments
Autodialer_CSV_Output = arcpy.GetParameterAsText(0)
if Autodialer_CSV_Output == '#' or not Autodialer_CSV_Output:
    Autodialer_CSV_Output = "I:\\CAD_Document Control Services\\Projects\\Complete\\220502 Design Calling Campaign CSV\\New Autodialer\\%WorkOrder%_autodial.csv" # provide a default value if unspecified

WorkOrder = arcpy.GetParameterAsText(1)

# Local variables:
Address_DeDuped = WorkOrder
Replace_Null_Name_with_String = WorkOrder
TempFeature = "%WorkOrder%TempFeature"
RES_Null_Fixed = TempFeature
RES_Null_Fixed__2_ = RES_Null_Fixed
RES_Null_Fixed__3_ = RES_Null_Fixed__2_
RES_Null_Fixed__4_ = RES_Null_Fixed__3_
RES_Null_Fixed__5_ = RES_Null_Fixed__4_
RES_Null_Fixed__6_ = RES_Null_Fixed__5_
DeDuped = RES_Null_Fixed__6_
New_Autodialer = "I:\\CAD_Document Control Services\\Projects\\Complete\\220502 Design Calling Campaign CSV\\New Autodialer"
Populate_Null_Address_from_field = Replace_Null_Name_with_String
Populate_Null_City_from_field = Populate_Null_Address_from_field
Populate_Null_State_from_field = Populate_Null_City_from_field
Populate_Null_Zip_from_field = Populate_Null_State_from_field
Concat_addresses = Populate_Null_Zip_from_field
Dissolve_for_Label = "I:\\CAD_Document Control Services\\Projects\\Complete\\210430 Addresses for Land Services\\bkup\\Address_Label.gdb\\%WorkOrder%_labels"

# Process: Make Temp Feature
arcpy.MakeFeatureLayer_management(WorkOrder, TempFeature, "", "", "OBJECTID OBJECTID VISIBLE NONE;ENABLED ENABLED VISIBLE NONE;CREATIONUSER CREATIONUSER VISIBLE NONE;DATECREATED DATECREATED VISIBLE NONE;DATEMODIFIED DATEMODIFIED VISIBLE NONE;LASTUSER LASTUSER VISIBLE NONE;SUBTYPECD SUBTYPECD VISIBLE NONE;FEEDERID FEEDERID VISIBLE NONE;FEEDERID2 FEEDERID2 VISIBLE NONE;LOCATIONNUMBER LOCATIONNUMBER VISIBLE NONE;WORKORDERID WORKORDERID VISIBLE NONE;INSTALLATIONDATE INSTALLATIONDATE VISIBLE NONE;ELECTRICTRACEWEIGHT ELECTRICTRACEWEIGHT VISIBLE NONE;FEEDERINFO FEEDERINFO VISIBLE NONE;SYMBOLROTATION SYMBOLROTATION VISIBLE NONE;PHASEDESIGNATION PHASEDESIGNATION VISIBLE NONE;ADDRESS ADDRESS VISIBLE NONE;CONNECTIONTYPE CONNECTIONTYPE VISIBLE NONE;SERVICECURRENTRATING SERVICECURRENTRATING VISIBLE NONE;CEA_GRID CEA_GRID VISIBLE NONE;STATUS STATUS VISIBLE NONE;COMMENTS COMMENTS VISIBLE NONE;SERVLOCNUMBER SERVLOCNUMBER VISIBLE NONE;MEDALERT MEDALERT VISIBLE NONE;TRANSFORMEROBJECTID TRANSFORMEROBJECTID VISIBLE NONE;LIFE_CYCLE_STATUS LIFE_CYCLE_STATUS VISIBLE NONE;SEQNUM SEQNUM VISIBLE NONE;X_COORDINATE X_COORDINATE VISIBLE NONE;Y_COORDINATE Y_COORDINATE VISIBLE NONE;TRANSFORMERLINKER TRANSFORMERLINKER VISIBLE NONE;TRANSFORMERLINKER_OID TRANSFORMERLINKER_OID VISIBLE NONE;FACILITYID FACILITYID VISIBLE NONE;LEGACYID LEGACYID VISIBLE NONE;LOCATION LOCATION VISIBLE NONE;WARRANTYDATE WARRANTYDATE VISIBLE NONE;INSTALLDATE INSTALLDATE VISIBLE NONE;CONDITION CONDITION VISIBLE NONE;CONDITIONDATE CONDITIONDATE VISIBLE NONE;INSERVICEDATE INSERVICEDATE VISIBLE NONE;WORKREQUESTID WORKREQUESTID VISIBLE NONE;DESIGNID DESIGNID VISIBLE NONE;WORKLOCATIONID WORKLOCATIONID VISIBLE NONE;WORKFLOWSTATUS WORKFLOWSTATUS VISIBLE NONE;WORKFUNCTION WORKFUNCTION VISIBLE NONE;POINTADDRESS_GUID POINTADDRESS_GUID VISIBLE NONE;PARCEL_NUM PARCEL_NUM VISIBLE NONE;PARCEL_ID PARCEL_ID VISIBLE NONE;SUBDIVISION_ID SUBDIVISION_ID VISIBLE NONE;PARCELFEATURECLASSNAME PARCELFEATURECLASSNAME VISIBLE NONE;SUBDIVISIONFEATURECLASSNAME SUBDIVISIONFEATURECLASSNAME VISIBLE NONE;PARCEL_ID_FIELD PARCEL_ID_FIELD VISIBLE NONE;SUBDIVISION_ID_FIELD SUBDIVISION_ID_FIELD VISIBLE NONE;LATITUDE LATITUDE VISIBLE NONE;LONGITUDE LONGITUDE VISIBLE NONE;GLOBALID GLOBALID VISIBLE NONE;CREATED_USER CREATED_USER VISIBLE NONE;CREATED_DATE CREATED_DATE VISIBLE NONE;LAST_EDITED_USER LAST_EDITED_USER VISIBLE NONE;LAST_EDITED_DATE LAST_EDITED_DATE VISIBLE NONE;ORG_SOURCE ORG_SOURCE VISIBLE NONE;FEATURE_ID FEATURE_ID VISIBLE NONE;MLP_CPR_MAPPOINT MLP_CPR_MAPPOINT VISIBLE NONE;ENTITY_ID ENTITY_ID VISIBLE NONE;SERVLOCNUMBER_1 SERVLOCNUMBER_1 VISIBLE NONE;ACCOUNT_NUM ACCOUNT_NUM VISIBLE NONE;ACCOUNT_SUB_NUM ACCOUNT_SUB_NUM VISIBLE NONE;C_ACCOUNT C_ACCOUNT VISIBLE NONE;METER_NUM METER_NUM VISIBLE NONE;XFMRLOCNUMBER XFMRLOCNUMBER VISIBLE NONE;RATE_CD RATE_CD VISIBLE NONE;OWN_OR_RENT_CD OWN_OR_RENT_CD VISIBLE NONE;MEDICALERT_DESC MEDICALERT_DESC VISIBLE NONE;BILLING_NAME BILLING_NAME VISIBLE NONE;BILLING_ADDR_1 BILLING_ADDR_1 VISIBLE NONE;BILLING_ADDR_2 BILLING_ADDR_2 VISIBLE NONE;BILLING_ADDR_3 BILLING_ADDR_3 VISIBLE NONE;BILLING_CITY BILLING_CITY VISIBLE NONE;BILLING_STATE BILLING_STATE VISIBLE NONE;BILLING_ZIP BILLING_ZIP VISIBLE NONE;BILLING_FOREIGN_ADDR BILLING_FOREIGN_ADDR VISIBLE NONE;BILLING_RES_PHONE BILLING_RES_PHONE VISIBLE NONE;BILLING_BUS_PHONE BILLING_BUS_PHONE VISIBLE NONE;SERVICE_ADDR_1 SERVICE_ADDR_1 VISIBLE NONE;SERVICE_PREFIX SERVICE_PREFIX VISIBLE NONE;SERVICE_ADDR_2 SERVICE_ADDR_2 VISIBLE NONE;SERVICE_SUFFIX SERVICE_SUFFIX VISIBLE NONE;SERVICE_SPACE_OR_UNIT_ID SERVICE_SPACE_OR_UNIT_ID VISIBLE NONE;SERVICE_CITY SERVICE_CITY VISIBLE NONE;LOT LOT VISIBLE NONE;BLOCK BLOCK VISIBLE NONE;SUBDIVISION SUBDIVISION VISIBLE NONE;LANDLORD_NAME LANDLORD_NAME VISIBLE NONE;LANDLORD_ADDR_1 LANDLORD_ADDR_1 VISIBLE NONE;LANDLORD_ADDR_2 LANDLORD_ADDR_2 VISIBLE NONE;LANDLORD_ADDR_3 LANDLORD_ADDR_3 VISIBLE NONE;LANDLORD_CITY LANDLORD_CITY VISIBLE NONE;LANDLORD_STATE LANDLORD_STATE VISIBLE NONE;LANDLORD_ZIP LANDLORD_ZIP VISIBLE NONE;LANDLORD_FOREIGN_ADDR LANDLORD_FOREIGN_ADDR VISIBLE NONE;LANDLORD_PHONE LANDLORD_PHONE VISIBLE NONE;AGENT_NAME AGENT_NAME VISIBLE NONE;AGENT_ADDR_1 AGENT_ADDR_1 VISIBLE NONE;AGENT_ADDR_2 AGENT_ADDR_2 VISIBLE NONE;AGENT_ADDR_3 AGENT_ADDR_3 VISIBLE NONE;AGENT_CITY AGENT_CITY VISIBLE NONE;AGENT_STATE AGENT_STATE VISIBLE NONE;AGENT_ZIP AGENT_ZIP VISIBLE NONE;AGENT_FOREIGN_ADDR AGENT_FOREIGN_ADDR VISIBLE NONE;AGENT_PHONE AGENT_PHONE VISIBLE NONE;READING_ROUTE READING_ROUTE VISIBLE NONE;READING_SEQ READING_SEQ VISIBLE NONE;NOTES NOTES VISIBLE NONE;BILLING_ROUTE BILLING_ROUTE VISIBLE NONE;LANDLORD LANDLORD VISIBLE NONE;BILLING_CYCLE BILLING_CYCLE VISIBLE NONE;AMR_ROUTE_GROUP AMR_ROUTE_GROUP VISIBLE NONE;ERT_NUMBER ERT_NUMBER VISIBLE NONE;ACCOUNT_STATUS ACCOUNT_STATUS VISIBLE NONE;LAST_UPDATE_DT LAST_UPDATE_DT VISIBLE NONE;LAST_UPDATE_ID LAST_UPDATE_ID VISIBLE NONE;OBJECTID_1 OBJECTID_1 VISIBLE NONE;C_SUBGROUP C_SUBGROUP VISIBLE NONE;D_DATEINSTALLED D_DATEINSTALLED VISIBLE NONE;C_METERFORM C_METERFORM VISIBLE NONE;N_MULTIPLIER N_MULTIPLIER VISIBLE NONE;GLOBALID_1 GLOBALID_1 VISIBLE NONE;CREATED_USER_1 CREATED_USER_1 VISIBLE NONE;CREATED_DATE_1 CREATED_DATE_1 VISIBLE NONE;LAST_EDITED_USER_1 LAST_EDITED_USER_1 VISIBLE NONE;LAST_EDITED_DATE_1 LAST_EDITED_DATE_1 VISIBLE NONE;ORG_SOURCE_1 ORG_SOURCE_1 VISIBLE NONE;FEATURE_ID_1 FEATURE_ID_1 VISIBLE NONE;ENTITY_ID_1 ENTITY_ID_1 VISIBLE NONE;SHAPE SHAPE VISIBLE NONE;GRIDSERVICENUMBER GRIDSERVICENUMBER VISIBLE NONE;EV_CHARGER EV_CHARGER VISIBLE NONE;EV_CHARGER_AMPS EV_CHARGER_AMPS VISIBLE NONE;OBJECTID_12 OBJECTID_12 VISIBLE NONE;C_ACCOUNT_1 C_ACCOUNT_1 VISIBLE NONE;SERV_LOC_NUM SERV_LOC_NUM VISIBLE NONE;C_EMAIL C_EMAIL VISIBLE NONE;PRIMARY PRIMARY VISIBLE NONE;CELL_1 CELL_1 VISIBLE NONE;CELL_2 CELL_2 VISIBLE NONE;BUSINESS BUSINESS VISIBLE NONE;GRID GRID VISIBLE NONE;C_LATITUDE C_LATITUDE VISIBLE NONE;C_LONGITUDE C_LONGITUDE VISIBLE NONE;DIVISION DIVISION VISIBLE NONE;CITY CITY VISIBLE NONE;C_ACCOUNTTYPE C_ACCOUNTTYPE VISIBLE NONE;SERVICE_ADDRESS SERVICE_ADDRESS VISIBLE NONE;C_CUSTOMER C_CUSTOMER VISIBLE NONE;CUSTOMER_NAME CUSTOMER_NAME VISIBLE NONE")

# Process: RES #
arcpy.CalculateField_management(TempFeature, "BILLING_RES_PHONE", "merge_fields(!BILLING_RES_PHONE!, !LANDLORD_PHONE!)", "PYTHON_9.3", "def merge_fields(BILLING_RES_PHONE, LANDLORD_PHONE):
    if BILLING_RES_PHONE is None or BILLING_RES_PHONE == '':
        return LANDLORD_PHONE
    else:
        return BILLING_RES_PHONE
")

# Process: RES # (2)
arcpy.CalculateField_management(RES_Null_Fixed, "BILLING_RES_PHONE", "merge_fields(!BILLING_RES_PHONE!, !AGENT_PHONE!)", "PYTHON_9.3", "def merge_fields(BILLING_RES_PHONE, AGENT_PHONE):
    if BILLING_RES_PHONE is None or BILLING_RES_PHONE == '':
        return AGENT_PHONE
    else:
        return BILLING_RES_PHONE
")

# Process: RES # (3)
arcpy.CalculateField_management(RES_Null_Fixed__2_, "BILLING_RES_PHONE", "merge_fields(!BILLING_RES_PHONE!, !PRIMARY!)", "PYTHON_9.3", "def merge_fields(BILLING_RES_PHONE, PRIMARY):
    if BILLING_RES_PHONE is None or BILLING_RES_PHONE == '':
        return PRIMARY
    else:
        return BILLING_RES_PHONE
")

# Process: RES # (4)
arcpy.CalculateField_management(RES_Null_Fixed__3_, "BILLING_RES_PHONE", "merge_fields(!BILLING_RES_PHONE!, !CELL_1!)", "PYTHON_9.3", "def merge_fields(BILLING_RES_PHONE, CELL_1):
    if BILLING_RES_PHONE is None or BILLING_RES_PHONE == '':
        return CELL_1
    else:
        return BILLING_RES_PHONE
")

# Process: RES # (5)
arcpy.CalculateField_management(RES_Null_Fixed__4_, "BILLING_RES_PHONE", "merge_fields(!BILLING_RES_PHONE!, !CELL_2!)", "PYTHON_9.3", "def merge_fields(BILLING_RES_PHONE, CELL_2):
    if BILLING_RES_PHONE is None or BILLING_RES_PHONE == '':
        return CELL_2
    else:
        return BILLING_RES_PHONE
")

# Process: RES # (6)
arcpy.CalculateField_management(RES_Null_Fixed__5_, "BILLING_RES_PHONE", "merge_fields(!BILLING_RES_PHONE!, !BUSINESS!)", "PYTHON_9.3", "def merge_fields(BILLING_RES_PHONE, BUSINESS):
    if BILLING_RES_PHONE is None or BILLING_RES_PHONE == '':
        return BUSINESS
    else:
        return BILLING_RES_PHONE
")

# Process: Del Dup Autodialer
arcpy.DeleteIdentical_management(RES_Null_Fixed__6_, "BILLING_NAME;BILLING_ADDR_3;BILLING_CITY;BILLING_STATE;BILLING_ZIP;BILLING_RES_PHONE;BILLING_BUS_PHONE;SERVICE_ADDR_1;SERVICE_PREFIX;SERVICE_ADDR_2;SERVICE_SUFFIX;SERVICE_SPACE_OR_UNIT_ID;SERVICE_CITY;LOT;BLOCK", "", "0")

# Process: Table to Table
arcpy.TableToTable_conversion(DeDuped, New_Autodialer, "%WorkOrder%_autodial.csv", "", "METER_NUM \"METER_NUM\" true true false 10 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,METER_NUM,-1,-1;BILLING_NAME \"BILLING_NAME\" true true false 32 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,BILLING_NAME,-1,-1;BILLING_ADDR_3 \"BILLING_ADDR_3\" true true false 32 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,BILLING_ADDR_3,-1,-1;BILLING_CITY \"BILLING_CITY\" true true false 25 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,BILLING_CITY,-1,-1;BILLING_STATE \"BILLING_STATE\" true true false 2 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,BILLING_STATE,-1,-1;BILLING_ZIP \"BILLING_ZIP\" true true false 9 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,BILLING_ZIP,-1,-1;BILLING_RES_PHONE \"BILLING_RES_PHONE\" true true false 12 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,BILLING_RES_PHONE,-1,-1;BILLING_BUS_PHONE \"BILLING_BUS_PHONE\" true true false 12 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,BILLING_BUS_PHONE,-1,-1;SERVICE_ADDR_1 \"SERVICE_ADDR_1\" true true false 12 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,SERVICE_ADDR_1,-1,-1;SERVICE_PREFIX \"SERVICE_PREFIX\" true true false 2 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,SERVICE_PREFIX,-1,-1;SERVICE_ADDR_2 \"SERVICE_ADDR_2\" true true false 26 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,SERVICE_ADDR_2,-1,-1;SERVICE_SUFFIX \"SERVICE_SUFFIX\" true true false 5 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,SERVICE_SUFFIX,-1,-1;SERVICE_SPACE_OR_UNIT_ID \"SERVICE_SPACE_OR_UNIT_ID\" true true false 12 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,SERVICE_SPACE_OR_UNIT_ID,-1,-1;SERVICE_CITY \"SERVICE_CITY\" true true false 25 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,SERVICE_CITY,-1,-1;LOT \"LOT\" true true false 128 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,LOT,-1,-1;BLOCK \"BLOCK\" true true false 128 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,BLOCK,-1,-1;SUBDIVISION \"SUBDIVISION\" true true false 128 Text 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,SUBDIVISION,-1,-1;LATITUDE \"LATITUDE\" true true false 8 Double 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,LATITUDE,-1,-1;LONGITUDE \"LONGITUDE\" true true false 8 Double 0 0 ,First,#,\\\\ceanet1\\profiles$\\NicolasD\\Documents\\ArcGIS\\Default.gdb\\E1813852,LONGITUDE,-1,-1", "")

# Process: NAME
arcpy.CalculateField_management(WorkOrder, "LANDLORD_NAME", "replaceNull(!LANDLORD_NAME!)", "PYTHON_9.3", "def replaceNull(LANDLORD_NAME):
   if LANDLORD_NAME is None:
      return 'Current Resident / Owner'
   else:
      return LANDLORD_NAME")

# Process: ADDRESS
arcpy.CalculateField_management(Replace_Null_Name_with_String, "LANDLORD_ADDR_3", "replaceNull(!LANDLORD_ADDR_3!, !BILLING_ADDR_3!)", "PYTHON_9.3", "def replaceNull(LANDLORD_ADDR_3, BILLING_ADDR_3):
   if LANDLORD_ADDR_3 is None:
      return BILLING_ADDR_3
   else:
      return LANDLORD_ADDR_3")

# Process: CITY
arcpy.CalculateField_management(Populate_Null_Address_from_field, "LANDLORD_CITY", "replaceNull(!LANDLORD_CITY!, !BILLING_CITY!)", "PYTHON_9.3", "def replaceNull(LANDLORD_CITY, BILLING_CITY):
   if LANDLORD_CITY is None:
      return BILLING_CITY
   else:
      return LANDLORD_CITY")

# Process: STATE
arcpy.CalculateField_management(Populate_Null_City_from_field, "LANDLORD_STATE", "replaceNull(!LANDLORD_STATE!, !BILLING_STATE!)", "PYTHON_9.3", "def replaceNull(LANDLORD_STATE, BILLING_STATE):
   if LANDLORD_STATE is None:
      return BILLING_STATE
   else:
      return LANDLORD_STATE")

# Process: ZIP
arcpy.CalculateField_management(Populate_Null_State_from_field, "LANDLORD_ZIP", "replaceNull(!LANDLORD_ZIP!, !BILLING_ZIP!)", "PYTHON_9.3", "def replaceNull(LANDLORD_ZIP, BILLING_ZIP):
   if LANDLORD_ZIP is None:
      return BILLING_ZIP
   else:
      return LANDLORD_ZIP")

# Process: CONCAT
arcpy.CalculateField_management(Populate_Null_Zip_from_field, "ADDRESS", "concatFields(!LANDLORD_CITY!, !LANDLORD_STATE!, !LANDLORD_ZIP!)", "PYTHON_9.3", "def concatFields( LANDLORD_CITY, LANDLORD_STATE, LANDLORD_ZIP):
      return str(LANDLORD_CITY) + \" \" + str(LANDLORD_STATE) + \" \" + str(LANDLORD_ZIP)")

# Process: DeDup Address
arcpy.DeleteIdentical_management(WorkOrder, "LANDLORD_NAME;LANDLORD_ADDR_3;ADDRESS", "", "0")

# Process: DISSOLVE
arcpy.Dissolve_management(Address_DeDuped, Dissolve_for_Label, "ADDRESS;LANDLORD_NAME;LANDLORD_ADDR_3", "", "MULTI_PART", "DISSOLVE_LINES")

